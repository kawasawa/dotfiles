---
mode: "agent"
description: "SDD (Spec-Driven Development) によるタスクの実装"
---

# 依頼事項

SDD (Spec-Driven Development) の 4 フェーズ (要件定義 / 基本設計 / 実装計画 / 実装) を順序立てて進行し、ユーザのタスクを実装する。

## 全体方針

- 口調は簡潔・具体的・中立とし、です/ます調をベースに過度な敬語や俗語を避ける
- 各フェーズ開始時にフェーズ名と目的を明示
- 重要なキーワードや決定事項は太字などで強調
- 各フェーズの最後に収集した情報を箇条書きまたはテーブルで要約
- ユーザの承認もしくは明示的な合意が得られるまで次フェーズへ進まない

## フェーズの流れ

### 0. 事前準備フェーズ

#### 目的

- タスクの仕様を管理する専用ディレクトリを作成し、開発の土台を整理

#### 実施手順

1. ユーザからタスクを受け取る
2. `./.ai-workspace/specs` ディレクトリが存在しなければ作成
3. `./.ai-workspace/specs` ディレクトリ内に「仕様ディレクトリ」を作成
   - ディレクトリ名: タスク内容を簡潔に表す英語のケバブケース
   - 例外: 同名のディレクトリが存在する場合は連番 (`-1`, `-2`, ...) を付与し衝突を回避
   - 作成例: 「記事コンポーネントを実装する」→ `./.ai-workspace/specs/create-article-component`
4. 作成したディレクトリのパスをユーザに報告
   - 報告例: 「仕様ディレクトリ `./.ai-workspace/specs/create-article-component` を作成しました」
5. ディレクトリ作成の報告後、自動的に「要件定義フェーズ」へ遷移

#### 例外

- 技術的な問題が発生した場合は、エラー内容をユーザに報告し、指示があるまで待機

### 1. 要件定義フェーズ

#### 目的

- タスクが満たすべき具体的な要件を明確にし、要件定義書として文書化

#### 実施手順

1. ユーザから与えられたタスクの概要に基づき、「仕様ディレクトリ」内に「要件定義書」を作成
   - 記述内容: タスクが満たすべき具体的な要件、下記は成果物の例
     - As-Is/To-Be
     - 機能要件一覧
     - 非機能要件一覧
     - 業務フロー一覧
     - ユースケース一覧
     - バッチ処理一覧
   - ファイル形式: Markdown
   - ファイル名: `requirements.md`
2. ユーザに要件定義書を提示し、承認を依頼
   - レビュー依頼例: 「要件定義書を作成しました。特に**機能要件**と**非機能要件**の過不足についてご確認ください。」
   - 修正依頼があればその内容を反映し、更新した要件定義書を再度提示
   - ユーザから「承認」や同義の同意表現（「了解」「OK」など）が得られたら基本設計フェーズへ遷移

### 2. 基本設計フェーズ

#### 目的

- 要件定義書に記載された要件を満たすための基本設計を策定し、設計書として文書化

#### 実施手順

1. 要件定義書に記載された要件に基づき、「仕様ディレクトリ」内に「基本設計書」を作成す
   - 記述内容: 要件を満たすための基本設計、下記は成果物の例
     - アーキテクチャ設計
     - テーブル設計
     - 画面設計
     - インターフェース設計
   - ファイル形式: Markdown
   - ファイル名: `design.md`
2. ユーザに基本設計書を提示し、承認を依頼
   - レビュー依頼例: 「基本設計書を作成しました。特に**アーキテクチャの妥当性**と**既存システムとの整合性**についてご確認ください。」
   - 修正依頼があればその内容を反映し、更新した基本設計書を再度提示
   - ユーザから「承認」や同義の同意表現（「了解」「OK」など）が得られたら実装計画フェーズへ遷移

#### 差戻し

- 過去のフェーズでの決定事項と矛盾が生じる場合は、該当フェーズへ戻ることを宣言し、更新後に再承認を依頼

### 3. 実装計画フェーズ

#### 目的

- 基本設計書に記載された設計を実現するための実装計画を策定し、計画書として文書化

#### 実施手順

1. 基本設計書に記載された設計に基づき、「仕様ディレクトリ」内に「実装計画書」を作成
   - 記述内容: 実装を行うための具体的な計画、下記は検討すべき事項
     - タスク分割
     - 実装順序
     - 依存関係
   - ファイル形式: Markdown
   - ファイル名: `tasks.md`
2. ユーザに実装計画書を提示し、承認を依頼
   - レビュー依頼例: 「実装計画書を作成しました。特に**タスクの粒度**と**実装順序の妥当性**についてご確認ください。」
   - 修正依頼があればその内容を反映し、更新した実装計画書を再度提示
   - ユーザから「承認」や同義の同意表現（「了解」「OK」など）が得られたら実装フェーズへ遷移

#### 差戻し

- 過去のフェーズでの決定事項と矛盾が生じる場合は、該当フェーズへ戻ることを宣言し、更新後に再承認を依頼

### 4. 実装フェーズ

#### 目的

- 実装計画書に基づいて実装を行い、要件定義書・基本設計書に記載された内容を実現

#### 実施手順

1. 実装計画書に記載されたタスクを順次実装
2. 実装中は以下を厳守
   - 要件定義書・基本設計書に記載された内容を遵守
   - 既存プロジェクトの規約やセキュリティ要件を遵守
   - テストコードを実装
   - コードレビューを適宜実施
3. 仕様変更や新たなリスクが判明した場合は、影響範囲と対応策を整理し、ユーザに報告・承認を依頼
   - 報告例: 「実装中に**新たな技術的制約**が判明しました。影響範囲は〇〇で、対応策として △△ を提案します。ご承認いただけますか？」
4. すべてのタスクが完了した時点で、以下の内容を含む最終サマリを作成
   - 要件要約（要件定義書より）
   - 設計要約（基本設計書より）
   - 実装内容要約（実装計画書・実装結果より）
   - 残課題・フォローアップ項目
5. 最終サマリをユーザに提示し、承認を依頼
   - 最終承認が得られた時点でプロンプトを完了とする

#### 差戻し

- 過去のフェーズでの決定事項と矛盾が生じる場合は、該当フェーズへ戻ることを宣言し、更新後に再承認を依頼
